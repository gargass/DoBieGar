{
    "contents" : "nowotwor <- \"BRCA\"\ngen <- \"SPEN\"\n\np <- matrix(1, nrow=10, ncol=2)\nfor (nowotworr in nowotwor)\n{\n  dane <- czestosci_variant[which(czestosci_variant$nowotwor==nowotworr), c(\"variant\", gen)]\n  colnames(dane) <- c(paste('variant ', nowotworr), paste(\"frequency \", nowotworr))\n  p <- cbind(p, dane)\n}\np <- p[, -c(1, 2)]\nrownames(p) <- NULL\nprint(p)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nnowotwory= c(\"GBMLGG\", \"BRCA\", \"KIPAN\", \"COADREAD\", \"STES\", \"GBM\", \"OV\",\n             \"UCEC\", \"KIRC\", \"HNSC\", \"LUAD\", \"LGG\", \"LUSC\", \"THCA\")\nvarianty <- c(\"Missense_Mutation\", \"Silent\", \"Frame_Shift_Del\", \"Frame_Shift_Ins\", \n              \"In_Frame_Del\", \"Nonsense_Mutation\", \"RNA\", \"Splice_Site\",  \n              \"In_Frame_Ins\", \"Nonstop_Mutation\")\n\ngeny <- read.table('p_value/lista_interesujacych_genow.txt', h=T)\ngeny <- as.matrix(geny)\n#nowotwor= 'BRCA'\n\nfor(nowotwor in nowotwory){\n  assign(paste(nowotwor, '_variant', sep=\"\"), read.table(paste('Zbiory/', nowotwor, '_variant.txt', sep=\"\")))\n}\n\n\nczestosci = matrix(nrow = 10*14, ncol=297+2)\n#czestosci[,1]=varianty\n\nfor (i in 1:length(nowotwory)){\n  dane <- get(paste(nowotwory[i], '_variant', sep=\"\"))\n  n = nrow(dane)/10\n  for (j in 1:length(varianty)){\n    czestosci[(i - 1)*length(varianty) + j, 1] <- nowotwory[i]\n    czestosci[(i - 1)*length(varianty) + j, 2] <- varianty[j]\n    for (k in 1:length(geny)){\n      czestosci[(i - 1)*length(varianty) + j, k+2] <- \n        round(nrow(dane[!is.na(dane[,k+4]) & dane[,k+4]==varianty[j], ])/n, 3)\n    }\n  }\n}\n\ncolnames(czestosci)=c('nowotwor', 'variant', geny)\n\nwrite.table(file=paste('czestosci_variant.txt', sep=\"\"), czestosci)\n\n\nfor (j in 1:length(nowotwory))\n{\n  \n  #dane = read.table(paste('Zbiory/', nowotwory[j],'.txt' ,sep=''), h=T)\n  n = nrow(get(paste('Zbiory/', nowotwory[j], '_variant')))/10\n  for (i in 1:length(varianty))\n  {\n    czestosci[i, j+1]=round(sum(get(paste('Zbiory/', nowotwory[j], '_variant'))\n                                [which(), i+5])/n, 3)\n    \n  }\n  \n  \n}\n\ncolnames(czestosci)=c('gen', nowotwory)\n\n\nwrite.table(file=paste('czestosci.txt', sep=\"\"), czestosci)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nczestosci <-read.table('czestosci.txt', h=T)\n\ncz = matrix(nrow=nrow(czestosci), ncol=2)\ncz[, 1]=as.character(czestosci[, 1])\nfor (i in 1:nrow(czestosci))\n{\n  cz[i, 2]=sum(czestosci[i, 2:ncol(czestosci)])\n}\ncolnames(cz)=c('gen', 'czestosc')\ncz[,2]= as.numeric(cz[, 2])\ncz[order(cz[, 2]),]\n\ncz2 = cz[198:nrow(cz),]\n\nwrite.table(cz2[,1], file = \"najczestsze_geny.txt\")\n\ncz2 <- as.data.frame(cz2)\ncz2[,1]\n\ndane <- read.table('Zbiory/KIPAN.txt', h=T)\ncbind(dane$time, dane$status)\nlibrary(ggplot2)\nlibrary(reshape2)\n\nmelted_dane <- melt(czestosci[which(czestosci$gen %in% cz2[,1]), ])\n\nbase_size <- 8\n\nggplot(data = melted_dane, aes(x=gen, y=variable, fill=value)) + \n  geom_tile() + theme_grey(base_size = base_size) + labs(x = \"\",y = \"\") + \n  scale_x_discrete(expand = c(0, 0)) + \n  scale_y_discrete(expand = c(0, 0)) + theme(legend.position = \"none\", \n                                             axis.ticks = element_blank(), \n                                             axis.text.x = element_text(size = base_size * 0.8, angle = 330, hjust = 0, colour = \"grey50\"))\n\n\n\n\n\nlibrary(ggplot2)\nlibrary(reshape2)\ndane <- read.table(\"p_value/p_value_NA.txt\", h=T)\nnajczestsze <- read.table(\"najczestsze_geny.txt\", h=T)\n\nmelted_dane <- melt(dane[which(dane$gen %in% geny$x[0:50]), ])\n\nbase_size <- 10\n\nggplot(data = melted_dane, aes(x=gen, y=variable, fill=value)) + \n  geom_tile() + theme_grey(base_size = base_size) + labs(x = \"\",y = \"\") + \n  scale_x_discrete(expand = c(0, 0)) + \n  scale_y_discrete(expand = c(0, 0)) + theme(legend.position = \"none\", \n                                            axis.ticks = element_blank(), \n                                            axis.text.x = element_text(size = base_size * 0.8, angle = 330, hjust = 0, colour = \"grey50\"))\n\n",
    "created" : 1453063357480.000,
    "dirty" : true,
    "encoding" : "",
    "folds" : "",
    "hash" : "4280291173",
    "id" : "70529991",
    "lastKnownWriteTime" : 80,
    "path" : null,
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}